{% set title = 'Mes démarches' %}
{% extends 'base.html.twig' %}

{% block body %}

<div class="columns is-multiline mt-2">
	{% for stepsByDay in stepsByDays %}

	<div class="column is-6">
		<div class="box">
			<div class="columns">
				<div class="column is-8">
					<h3 class="title is-size-6">
						{{stepsByDay.date|format_datetime('full', 'none', locale='fr')}}
					</h3>
					<p class="subtitle is-size-6">
						{{stepsByDay.steps|length}}
						démarche(s) réalisée(s)
					</p>
				</div>
				<div class="column">
					<a class="button is-small"
						href="{{ path('app_user_steps_new', parameters = {'selected_date'  : stepsByDay.date}) }}">
						Ajouter une démarche
					</a>
				</div>
			</div>
			<table class="table is-fullwidth">
				<thead>
					<tr>
						<th>
							<abbr title="Catégorie">Cat</abbr>
						</th>
						<th>Durée</th>
						<th>Commentaire</th>
						<th>Action</th>

					</tr>
				</thead>
				<tbody>

					{% for step in stepsByDay.steps %}
					<tr>
						<td title="{{ step.step.name }}">
							{{ step.step.name|length > 20 ? step.step.name|slice(0, 20) ~ '...' : step.step.name}}
						</td>
						<td>
							{{step.duration|format_datetime('none', 'short', locale='fr') }}
							heure(s)
						</td>
						<td title="{{ step.comment }}">
							{{ step.comment|length > 4 ? step.comment|slice(0, 4) ~ '...' : step.comment}}
						</td>
						<td class="has-text-centered">
							<a class="button is-small" href="{{ path('app_user_steps_edit', { id: step.id }) }}">
								<span class="icon is-small">
									<i class="fa fa-pencil" aria-hidden="true"></i>
								</span>
							</a>
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
	{% endfor %}
	<div class="column is-6">
		<div class="box">
			<h3 class="title has-text-centered is-size-6">Total</h3>
			<table class="table">
				<thead>
					<tr>
						<th>Jour</th>
						<th>
							<abbr title="Catégorie">Cat</abbr>
						</th>
						<th>Durée</th>
					</tr>
				</thead>
				<tbody>
					{% for day in stepsByDays %}

					<tr>
						<td>
							{{day.date|format_datetime('full', 'none', locale='fr')|split(' ')|first|
							capitalize}}
						</td>
						<td>
							{% for step in day.steps %}
							{{ step.step.name|length > 20 ? step.step.name|slice(0, 20) ~ '...' :
							step.step.name}}
							<br>

							{% endfor %}
						</td>
						<td>
							{% for step in day.steps %}
							{{step.duration|format_datetime('none', 'short', locale='fr') }}
							heure(s)
							<br>

							{% endfor %}
						</td>


					</tr>
					{% endfor %}

				</tbody>
			</table>
		</div>
	</div>
</div>
{% endblock %}